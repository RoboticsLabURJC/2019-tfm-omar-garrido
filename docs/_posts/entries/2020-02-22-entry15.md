---
title: "Evaluating Rosify Difodo VS SD-SLAM"
excerpt: "Compare with TUM RGBD dataset Rosify Difodo and SD-SLAM"

sidebar:
  nav: "docs"
  
toc: true
toc_label: "Index"
toc_icon: "cog"
classes: wide
  

categories:
- entries
tags:
- evaluation
- TUM
- rosify_difodo
- SD-SLAM


author: Omar Garrido
pinned: false
---

As the previous entry concluded, the next step is to evaluate the performance of both odometry/slam algorithms, rosify_difodo and SD-SLAM.

# Processing TUM dataset

In order to make this task easier and allow easy reproducibility, Ive created automated scripts to process with one script all TUM sequences in rosbag format within a directory. For this two scripts has been created:
- process_one_TUM_sequence.sh
- process_all_sequences_TUM.sh

Both scripts can be found on the scripts repo directory: https://github.com/RoboticsLabURJC/2019-tfm-omar-garrido/tree/master/scripts

## process_one_TUM_sequence.sh
This script receives as an argument a sequence or rosbag from then TUM dataset. Then it creates a groundturuth file for SD-SLAM and rosify_difodo. The output directory where result files for each algorithm are going to be created are within the configuration of the odometry_evaluation_creator_file rospackage.

### How to use
```
$ process_one_TUM_sequence.sh myrosbagfilefromTUM.rosbag
```


## process_all_sequences_TUM.sh

This script gets as an argument a directory where rosbag sequences from TUM dataset are located within. All the sequences within this directory will be processed to create the results of odometry for SD-SLAM and rosify_difodo by executing **process_one_TUM_sequence.sh**.


### How to use
```
./process_all_sequences_TUM.sh /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/myrosbagSequences/
```

### Order of files created

Once it has been finished, one can do the following to know the order that the sequences have been generated, in order to change the name so they have meanignful names.

This will get the order of the files that has been processed.
```
$ cat processed_files_order.log

Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_long_office_household.bag on sáb feb 22 12:18:24 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_notexture_far.bag on sáb feb 22 12:23:25 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_notexture_near_withloop.bag on sáb feb 22 12:24:18 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_texture_far.bag on sáb feb 22 12:26:17 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_texture_near_withloop.bag on sáb feb 22 12:27:08 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_halfsphere.bag on sáb feb 22 12:30:01 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_rpy.bag on sáb feb 22 12:32:09 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_static.bag on sáb feb 22 12:33:46 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_xyz.bag on sáb feb 22 12:35:11 CET 2020
Proccessing file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_notexture_far.bag on sáb feb 22 12:37:41 CET 2020
```

**To get the exact time where rosify_difodo output file was created for each file do:**
```
$ cat process_all_debug.log | grep ROSIFY_DIFODO

-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_long_office_household.bag on sáb feb 22 12:18:24 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_notexture_far.bag on sáb feb 22 12:23:25 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_notexture_near_withloop.bag on sáb feb 22 12:24:18 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_texture_far.bag on sáb feb 22 12:26:17 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_texture_near_withloop.bag on sáb feb 22 12:27:08 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_halfsphere.bag on sáb feb 22 12:30:01 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_rpy.bag on sáb feb 22 12:32:09 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_static.bag on sáb feb 22 12:33:46 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_xyz.bag on sáb feb 22 12:35:11 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_notexture_far.bag on sáb feb 22 12:37:41 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_notexture_near.bag on sáb feb 22 12:39:08 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_texture_far.bag on sáb feb 22 12:41:01 CET 2020-------------
-------------ROSIFY_DIFODO: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_texture_near.bag on sáb feb 22 12:42:51 CET 2020-------------

```
**To get the exact time where SD-SLAM output file was created for each file do:**
```
$ cat process_all_debug.log | grep "SD-SLAM RGBD"

-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_long_office_household.bag on sáb feb 22 12:21:55 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_notexture_far.bag on sáb feb 22 12:23:59 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_notexture_near_withloop.bag on sáb feb 22 12:25:36 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_texture_far.bag on sáb feb 22 12:26:49 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_nostructure_texture_near_withloop.bag on sáb feb 22 12:29:01 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_halfsphere.bag on sáb feb 22 12:31:28 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_rpy.bag on sáb feb 22 12:33:15 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_static.bag on sáb feb 22 12:34:44 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_sitting_xyz.bag on sáb feb 22 12:36:56 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_notexture_far.bag on sáb feb 22 12:38:37 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_notexture_near.bag on sáb feb 22 12:40:21 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_texture_far.bag on sáb feb 22 12:42:16 CET 2020-------------
-------------SD-SLAM RGBD: Process file: /home/omar/Documents/rosbag/rgbd_TUM/freidburg3/sequences//rgbd_dataset_freiburg3_structure_texture_near.bag on sáb feb 22 12:44:15 CET 2020-------------
```

# Comparing results with groundtruth

The tool thats is going to be use to compare the results of SD-SLAM and rosify_difodo against the groundtruthof TUM dataset is [EVO](https://github.com/MichaelGrupp/evo)

How to install and use EVO was already discuss in a previous entry on this blog, check it [here](https://roboticslaburjc.github.io/2019-tfm-omar-garrido/entries/entry13/#evo-evaluation-tool).

In order to do this Ive created a python script that allows to compare using evo package as an "import".

## compare_groundtruth_odometry_TUM.py
This python script that can be found [here](https://github.com/RoboticsLabURJC/2019-tfm-omar-garrido/blob/master/scripts/compare_groundtruth_odometry_TUM.py) allows to compare multiple groundtruth files within a directory against the estimated files from another directory.
Both directories are passed as arguments to the python script.
The script expects the estimated files to have the same "name of sequence" as the groundtruth in order to find them. For example:
Groundtruth file from TUM: **rgbd_dataset_freiburg1_desk-groundtruth.txt**
Expected name for estimated file: **\*f1_desk-\*.txt** where "\*" can be anything. f1 means that is a freiburg1 sequence and then **desk** is the name of the original sequence.